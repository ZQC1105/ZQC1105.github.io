下面把 EF Core 在“投影（Select）”环节对实体实例是否跟踪的判定规则，用一句话概括后再逐条展开：

一句话  
**只要结果集里出现了“可跟踪的实体实例”（keyed 实体类型），EF Core 就会把它放进变更跟踪器；无键实体、纯值元组、匿名对象本身不会触发跟踪。**

逐条规则  
1. 返回匿名类型/自定义类型没关系，**只要里面包含实体实例**，就跟踪该实例。  
   ```csharp
   new { Blog = b, PostCount = b.Posts.Count() }   // Blog 被跟踪
   ```

2. 结果来自 LINQ 组合（如 `LastOrDefault()`）但**最终仍得到实体实例**，一样跟踪。  
   ```csharp
   new { Blog = b, Post = b.Posts.OrderBy(...).LastOrDefault() } // Post 被跟踪
   ```

3. 结果里**只有标量值**，没有实体实例，不跟踪。  
   ```csharp
   new { Id = b.BlogId, b.Url }   // 无跟踪
   ```

4. 顶级投影中出现**客户端方法**（EF Core 必须先把实体实例化出来传给你），实例化出来的实体会被跟踪。  
   ```csharp
   .Select(b => new { Url = StandardizeUrl(b) })   // b 被跟踪
   ```

5. 无键实体（`[Keyless]`/`DbQuery<T>`）**永远不会被跟踪**，即使出现在结果集里。

6. 跟踪只针对“实体类型”，匿名对象、值元组、DTO/POCO 等非实体类型本身不受跟踪；它们只是容器。

记住：  
“有没有出现可跟踪的实体实例”是判断的唯一标准，与容器是匿名类型、DTO 还是客户端方法无关。